extends layout_v2

block headerbottom


block content


    div(id="homepage-header" class="container-fluid")
      div(class="row")
        div(class="col-xs-12")
          div(class="jumbotron")
            p()
              span(id="market-size") #{market_size.number} #{market_size.scale} שקל
              |  מנוהלים בקרנות הפנסיה ובקופות הגמל.
              br()
              | איך ואיפה מנוהל הכסף שלנו?
          div(id="content-types")
            ul(class="nav nav-tabs")
              li(class="active")
                a(href="#home" data-toggle="tab") גופים מוסדיים
              li
                a(href="#profile" data-toggle="tab")מנפיקים 
                  span(class="soon") בקרוב

    div(id="homepage-content" class="container")
      div(class="row")
        div(class="col-xs-12")
          form()
            label()
              input(type="radio" name="mode" value="size" checked)
              |  Size
            label()
              input(type="radio" name="mode" value="count")
              |  Count
          
          script(src="treemap/d3.js")
          script(src="js/homepage_clientside.js")
          script.
            var root = !{JSON.stringify(treemapData)};
            var node = div.datum(root).selectAll(".node")
                .data(treemap.nodes)
                .enter().append("div")
                .attr("class", "node")
                .attr("onclick",function(d){return "window.location = '/portfolio?managing_body="+d.name+"&report_year=#{report_year}&report_qurater=#{report_qurater}'"})
                .call(position)
                .style("background", function(d) { return d.children ? color(d.name) : null; })
                .style("cursor", "pointer")                
                .text(function(d) { return d.children ? null : d.translatedName; });

            d3.selectAll("input").on("change", function change() {
              var value = this.value === "count"
                  ? function() { return 1; }
                  : function(d) { return d.size; };

              node
                .data(treemap.value(value).nodes)
                .transition()
                .duration(1500)
                .call(position);
            });
            